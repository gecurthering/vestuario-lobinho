<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Hello World</title>
</head>
  <script src="pixi.min.js"></script>
<body>
  <script type="text/javascript">
    let type = "WebGL"
    if(!PIXI.utils.isWebGLSupported()){
      type = "canvas"
    }

//Create a Pixi Application

let rosto;
var xcerto, ycerto, nivel;
nivel=1;

let app = new PIXI.Application({
    width: window.innerWidth,
    height: window.innerHeight,
    backgroundColor: 0xF0F0A0
    });
document.body.appendChild(app.view);

app.loader
    .add('meiofigure', 'https://vsolymossy.github.io/fluffy-guacamole/meiofigure.png')
    .add('di_pro', 'https://vsolymossy.github.io/fluffy-guacamole/promessa_lobinho.PNG')
    .add('feliz', 'https://vsolymossy.github.io/fluffy-guacamole/meiofigurefeliz.png')
    .add('triste', 'https://vsolymossy.github.io/fluffy-guacamole/meiofiguretriste.png')
    .add('di_wosm', 'https://vsolymossy.github.io/fluffy-guacamole/wosm.PNG')
    .load(setup);

function setup() {

    let meiofigure = new PIXI.Sprite.from(app.loader.resources.meiofigure.texture);
    meiofigure.scale.set(3);
    
    rosto = new PIXI.Sprite.from(app.loader.resources.feliz.texture);
    rosto.scale.set(3);

app.stage.addChild(meiofigure);
app.stage.addChild(rosto);

fase(nivel);
//app.ticker.add(fase1)
}

function fase(nivel) {
    switch(nivel){
    
    case 1:
    xcerto=570;
    ycerto=450;
    let di2 = new PIXI.Sprite.from(app.loader.resources.di_wosm.texture);
    di2.scale.set(0.20);
    di2.anchor.set(0.5);
    di2.interactive = true;
    di2.cursor = 'grab';
    di2.x=100;
    di2.y=100;



    texto = new PIXI.Text('Distintivo da WOSM');
    texto.x = 50;
    texto.y = 30;
    app.stage.addChild(texto);
    app.stage.addChild(di2);
    di2
        .on('pointerdown', onDragStart)
        .on('pointerup', onDragEnd)
        .on('pointerupoutside', onDragEnd)
        .on('pointermove', onDragMove);
    break;

    case 2:
    app.stage.removeChild(texto);
    xcerto=575;
    ycerto=577;
    let di1 = new PIXI.Sprite.from(app.loader.resources.di_pro.texture);
    di1.scale.set(0.18);
    di1.anchor.set(0.5);
    di1.interactive = true;
    di1.cursor = 'grab';
    di1.x=100;
    di1.y=100;

    texto2 = new PIXI.Text('Distintivo de Promessa');
    texto2.x = 50;
    texto2.y = 30;
    app.stage.addChild(texto2);
    app.stage.addChild(di1);
    di1
        .on('pointerdown', onDragStart)
        .on('pointerup', onDragEnd)
        .on('pointerupoutside', onDragEnd)
        .on('pointermove', onDragMove);
    break;
    }
}



function onDragStart(event) {
    // store a reference to the data
    // the reason for this is because of multitouch
    // we want to track the movement of this particular touch
    this.data = event.data;
    this.alpha = 0.5;
    this.dragging = true;
}

function onDragEnd() {
    this.alpha = 1;
    this.dragging = false;
    // set the interaction data to null
    this.data = null;
    
     verificapos(this.x, this.y, this);
       
}

function onDragMove() {
    if (this.dragging) {
        const newPosition = this.data.getLocalPosition(this.parent);
        this.x = newPosition.x;
        this.y = newPosition.y;
    }
}

function verificapos(xatual, yatual, objeto){

if(xatual>xcerto-30 && xatual<xcerto+30 && yatual>ycerto-30 && yatual<ycerto+30){
    rosto.texture=app.loader.resources.feliz.texture;
    objeto.interactive=false;
    objeto.x=xcerto;
    objeto.y=ycerto;
    nivel=nivel+1;
    fase(nivel);
    }else{
    rosto.texture=app.loader.resources.triste.texture;
    }
return

}
    
</script>
</body>
</html>
